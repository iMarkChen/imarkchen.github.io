import{_ as F,s as X,y as B,x as G,o as W,c as D,p as L,i as O,a as l}from"./index.cc01b20d.js";const C="/assets/player.f901c4c5.png",R="/assets/enemy_1.d65438c9.png",U="/assets/background_single.73dcf839.png";const m=d=>(L("data-v-b4e2a7b0"),d=d(),O(),d),Y={class:"canvas-game"},q=m(()=>l("canvas",{id:"canvas1",class:"canvas"},null,-1)),M=m(()=>l("img",{src:C,alt:"playerImage",id:"playerImage",class:"playerImage"},null,-1)),$=m(()=>l("img",{src:R,alt:"enemyImage",id:"enemyImage",class:"enemyImage"},null,-1)),N=m(()=>l("img",{src:U,alt:"backgroundImage",id:"backgroundImage",class:"backgroundImage"},null,-1)),P=[q,M,$,N],V={__name:"CanvasGame",setup(d){let a=[],n=0,g=!1;class v{constructor(){this.keys=[],window.addEventListener("keydown",t=>{!this.keys.includes(t.key)&&(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&this.keys.push(t.key)}),window.addEventListener("keyup",t=>{(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&this.keys.splice(this.keys.indexOf(t.key),1)})}}class I{constructor(t,s){this.gameHeight=s,this.gameWdith=t,this.width=200,this.height=200,this.x=0,this.y=this.gameHeight-this.height,this.image=document.getElementById("playerImage"),this.frameX=0,this.frameY=0,this.maxFrame=8,this.speed=0,this.vy=0,this.weight=1,this.fps=20,this.frameTimer=0,this.frameInterval=1e3/this.fps}draw(t){t.fillStyle="white",t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height)}update(t,s,S){S.forEach(r=>{const _=r.x+r.width/2-20-(this.x+this.width/2),k=r.y+r.height/2+40-(this.y+this.height/2);Math.sqrt(_*_+k*k)<r.width/2+this.width/2&&(g=!0)}),this.frameTimer>this.frameInterval?(this.frameX>=this.maxFrame?this.frameX=0:this.frameX++,this.frameTimer=0):this.frameTimer+=s,t.keys.indexOf("ArrowRight")>-1?this.speed=5:t.keys.indexOf("ArrowLeft")>-1?this.speed=-5:t.keys.indexOf("ArrowUp")>-1&&this.onGround()?this.vy-=28:this.speed=0,this.x+=this.speed,this.x<0?this.x=0:this.x>this.gameWdith-this.width&&(this.x=this.gameWdith-this.width),this.y+=this.vy,this.onGround()?(this.vy=0,this.maxFrame=8,this.frameY=0):(this.vy+=this.weight,this.maxFrame=6,this.frameY=1),this.y>this.gameHeight-this.height&&(this.y=this.gameHeight-this.height)}onGround(){return this.y>=this.gameHeight-this.height}}class x{constructor(t,s){this.gameWdith=t,this.gameHeight=s,this.image=document.getElementById("enemyImage"),this.width=160,this.height=119,this.x=this.gameWdith,this.y=this.gameHeight-this.height,this.frameX=0,this.maxFrame=5,this.speed=8,this.fps=10,this.frameTimer=0,this.frameInterval=1e3/this.fps,this.markedForDeletion=!1}draw(t){t.drawImage(this.image,this.frameX*this.width,0,this.width,this.height,this.x,this.y,this.width,this.height)}update(t){this.frameTimer>this.frameInterval?(this.frameX>=this.maxFrame?this.frameX=0:this.frameX++,this.frameTimer=0):this.frameTimer+=t,this.x-=this.speed,this.x<0-this.width&&(this.markedForDeletion=!0,n++)}}class T{constructor(t,s){this.gameWdith=t,this.gameHeight=s,this.image=document.getElementById("backgroundImage"),this.x=0,this.y=0,this.width=2400,this.height=720,this.speed=5}draw(t){t.drawImage(this.image,this.x,this.y,this.width,this.height),t.drawImage(this.image,this.x+this.width-1,this.y,this.width,this.height)}update(){this.x-=this.speed,this.x<0-this.width&&(this.x=0)}}function b(i){f>H+E?(a.push(new x(e.width,e.height)),f=0):f+=i,a.forEach(t=>{t.draw(h),t.update(i)}),a=a.filter(t=>!t.markedForDeletion)}function A(i){i.textAlign="left",i.font="40px Helvetica",i.fillStyle="black",i.fillText(`\u5F97\u5206: ${n}`,20,50),i.fillStyle="white",i.fillText(`\u5F97\u5206: ${n}`,22,50),i.textAlign="right",i.font="20px Helvetica",i.fillStyle="black",i.fillText("\u901A\u8FC7\u65B9\u5411\u952E\u79FB\u52A8\u548C\u8DF3\u8DC3",e.width-10,30),i.fillStyle="white",i.fillText("\u901A\u8FC7\u65B9\u5411\u952E\u79FB\u52A8\u548C\u8DF3\u8DC3",e.width-8,30),g&&(i.textAlign="center",i.font="50px Helvetica",i.fillStyle="black",i.fillText("\u6E38\u620F\u7ED3\u675F",e.width/2,200),i.fillStyle="white",i.fillText("\u6E38\u620F\u7ED3\u675F",e.width/2+2,200+2),i.font="30px Helvetica",i.fillStyle="black",i.fillText("\u5237\u65B0\u9875\u9762\u91CD\u8BD5",e.width/2,200+50),i.fillStyle="white",i.fillText("\u5237\u65B0\u9875\u9762\u91CD\u8BD5",e.width/2+2,200+2+50))}let w=0,f=0,H=1e3,E=Math.random()*1e3+500,y;function p(i){const t=i-w;w=i,h.clearRect(0,0,e.width,e.height),c.draw(h),c.update(),o.draw(h),o.update(u,t,a),b(t),A(h),g||(y=requestAnimationFrame(p))}let e,h,u,o,c;return X(async()=>{await B(),e=document.getElementById("canvas1"),h=e.getContext("2d"),e.width=1e3,e.height=600,u=new v,o=new I(e.width,e.height),c=new T(e.width,e.height),p(0)}),G(()=>{window.cancelAnimationFrame(y)}),(i,t)=>(W(),D("div",Y,P))}},J=F(V,[["__scopeId","data-v-b4e2a7b0"]]);export{J as default};
